{{ $revisions := partial "turing/revisions/page-revisions" . }}
{{ $page := . }}
{{ $revisionsCount := len $revisions }}
{{ if $revisions }}
    {{ $page = index $revisions 0 }}
{{ end }}
<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>{{ .Site.Title }}{{ $url := urls.Parse .Page.Permalink }}{{ $url.Path }}</title>
    {{ with .Site.Params.description }}<meta name="description" content="{{ . }}">{{ end }}
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {{- if and (eq .Kind "section") (eq .Type "turing/revisions") -}}
      <meta name="robots" content="noindex">
      <link rel="canonical" href="{{ $page.Permalink  }}">
      {{ if (ne $revisionsCount 1) }}
      <meta http-equiv="refresh" content="30; url={{ $page.Permalink }}">
      {{ end }}
    {{- else -}}
      <meta name="robots" content="all,follow">
      <meta name="googlebot" content="index,follow,snippet,archive">
    {{ end }}
    {{ partialCached "turing/console-theme/stylesheet" "terminalcss" "termianlcss" }}
    <link rel="stylesheet" href="{{ "hugo-theme-console/css/animate-4.1.1.min.css" | absURL }}">
    {{ `
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
    ` | safeHTML }}

    {{- partial "favicon.html" . -}}
    {{ with .OutputFormats.Get "RSS" }}
      {{ printf `<link href="%s" rel="%s" type="%s" title="%s" />` .Permalink .Rel .MediaType.Type $.Site.Title | safeHTML }}
    {{ end }}
    {{- partial "opengraph.html" . -}}
    {{- partial "twitter_cards.html" . -}}
    {{ template "_internal/google_analytics.html" . }}

    {{- partial "header.html" . -}}
    <style type="text/css">
      .banner {
        position: relative;
        margin: auto 0;
        display: table-cell;
  padding: calc(var(--global-space) * 2)0;
  overflow:hidden ;
      }
      .banner::before {
        content: "-------------------------------------------------------------------------------------------------------";
position: absolute;
top: 0px;
left: 0;
display: var(--display-h1-decoration);
      }
      .banner::after {
        content: "====================================================================================================";
position: absolute;
bottom: 0px;
left: 0;
display: var(--display-h1-decoration);
      }
    </style>
</head>
<body class="terminal">
    <div class="container">
      <div class="terminal-nav">
          <nav class="terminal-menu">
            {{ partial "menu.html" (dict "menuID" "main" "page" .) }}

            <ul vocab="https://schema.org/" style="margin-bottom: var(--global-space);" typeof="BreadcrumbList">
                <li style="margin-right: auto;"><a href="{{ .Site.BaseURL }}" class="no-style {{ with .Site.Params.TitleCutting }}site-name{{ end }}">home</a>/</li>

                {{ range .Site.Params.navlinks }}
                <li><a href="{{ absURL .url }}" typeof="ListItem">{{ .name }}</a></li>
                {{ end }}
            </ul>
          </nav>
        </div>
        {{ partial "turing/console-theme/banner.html" . }}
      </div>


    <div class="container {{ .Site.Params.animateStyle }}" >
      <div class="terminal-nav">
        <div class="terminal-prompt" >
          {{ $url := replaceRE `\.html$` "" .RelPermalink  }}
          {{ $.Scratch.Add "path" .Site.BaseURL }}
          <a href="{{ .Site.BaseURL }}" class="no-style {{ with .Site.Params.TitleCutting }}site-name{{ end }}">{{ .Site.Title }}</a>:~$ 
          {{ $prefix := "cat" }}
          {{ $suffix := "" }}
          {{ $elements := split $url "/" }}
          {{ if eq .Kind "section" -}}
            {{ if ne .Type "revisions"}}
              {{ $prefix = "ls -l" }}
              {{ $suffix = "/" }}
            {{ else }}
              {{ $max := 0 }}
              {{ $slug := default nil }}
              {{ range page.Data.Pages }}
                {{ if ne .Params.revision.id nil }}
                  {{ if lt $max .Params.revision.id }}
                    {{ $max = .Params.revision.id }}
                    {{ $slug = .Slug }}
                  {{ end }}
                {{ end }}
              {{ end }}
              {{ if ne $slug nil }}
                {{ $elements = $elements | append $slug }}
              {{ end }}
            {{ end }}
          {{ end }}
          {{ if eq .Kind "home" }}
            {{ $prefix }} <a href="{{ .Permalink }}">{{ .Kind }}</a>{{ $suffix }}
          {{ else }}
            {{ $prefix }} {{ range $index, $element := $elements -}}
              {{ $.Scratch.Add "path" $element }}
                {{- if and (gt $index 1) (lt $index (sub (len $elements) 1)) -}}
                /
                {{- end -}}
                {{- if ne $element "" -}}<a href='{{ $.Scratch.Get "path" | absURL }}'>{{ . }}</a>
                  {{- $.Scratch.Add "path" "/" -}}
                {{- end -}}
            {{ end -}}
            {{- $suffix }}
          {{ end }}
        </div>
      </div>
      {{- if and (eq .Kind "section") (eq .Type "turing/revisions") -}}
        {{ if (ne $revisionsCount 1) }}
          <p>Page moved: ~{{ .RelPermalink }} -> <a href="{{ $page.Permalink }}">~{{ $page.RelPermalink }}</a>.</p>
        {{ else }}
          {{ replaceRE `href="(#[^"]*)"` (printf `href="%s$1"` $page.RelPermalink) $page.Content | safeHTML }}
        {{ end }}
      {{ else }}
        {{ block "main" . }}
        {{ end }}
      {{ end }}
        {{ partial "turing/console-theme/footer.html" . }}
    </div>
  </body>
</html>